

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fragmenter.utils package &mdash; fragmenter 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="fragmenter.logging package" href="fragmenter.logging.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            fragmenter
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">fragmenter</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="fragmenter.html">fragmenter package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fragmenter.html#fragmenter.fragmenter"><code class="docutils literal notranslate"><span class="pre">fragmenter</span></code></a></li>
<li class="toctree-l3 current"><a class="reference internal" href="fragmenter.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="fragmenter.data.html">fragmenter.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="fragmenter.logging.html">fragmenter.logging package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">fragmenter.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fragmenter.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="fragmenter.html#module-fragmenter.typing">fragmenter.typing module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fragmenter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">fragmenter</a></li>
          <li class="breadcrumb-item"><a href="fragmenter.html">fragmenter package</a></li>
      <li class="breadcrumb-item active">fragmenter.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/fragmenter.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-fragmenter.utils">
<span id="fragmenter-utils-package"></span><h1>fragmenter.utils package<a class="headerlink" href="#module-fragmenter.utils" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="fragmenter.utils.draw_mol_with_highlights_and_legend">
<span class="sig-prename descclassname"><span class="pre">fragmenter.utils.</span></span><span class="sig-name descname"><span class="pre">draw_mol_with_highlights_and_legend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_aromatic_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_width_and_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fragmenter.utils.draw_mol_with_highlights_and_legend" title="Link to this definition"></a></dt>
<dd><p>Draws a 2D depiction of a molecule with highlighted groups and a legend.</p>
<p>The function renders the molecule using RDKit, highlights specified groups
of atoms and bonds with semi-transparent colors, and adds a legend showing the
group names and counts. Optionally, aromatic bonds and atoms can be highlighted.
You can get more info from here:
<a class="reference external" href="https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html">https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html</a>
<a class="reference external" href="https://greglandrum.github.io/rdkit-blog/posts/2023-05-26-drawing-options-explained.html">https://greglandrum.github.io/rdkit-blog/posts/2023-05-26-drawing-options-explained.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – The molecule to be drawn. It must consist of a single fragment.</p></li>
<li><p><strong>group_dict</strong> (<em>dict</em>) – A dictionary where each key maps to a list of groups (each group is
a list of atom indices) to be highlighted.</p></li>
<li><p><strong>group_names</strong> (<em>dict</em><em>, </em><em>optional</em>) – A mapping of group keys to their display names for the legend.
Defaults to None.</p></li>
<li><p><strong>group_colors</strong> (<em>dict</em><em>, </em><em>optional</em>) – A mapping of group keys to RGB color tuples for highlighting.
If None, a default palette is used. Defaults to None.</p></li>
<li><p><strong>show_aromatic_info</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, aromatic bonds and atoms are highlighted.
Defaults to True.</p></li>
<li><p><strong>img_width_and_height</strong> (<em>int</em><em>, </em><em>optional</em>) – The width and height (in pixels) for the image.
If not provided, a suitable size is determined automatically. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An image of the molecule with highlights and a legend.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PIL.Image.Image</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the molecule consists of more than one fragment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fragmenter.utils.get_table_with_atom_properties_relevant_to_SMARTS">
<span class="sig-prename descclassname"><span class="pre">fragmenter.utils.</span></span><span class="sig-name descname"><span class="pre">get_table_with_atom_properties_relevant_to_SMARTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fragmenter.utils.get_table_with_atom_properties_relevant_to_SMARTS" title="Link to this definition"></a></dt>
<dd><p>Generates a table of atom properties relevant to SMARTS pattern matching.</p>
<p>The function extracts various properties for each atom in the molecule such as
atomic symbol, charge, aromaticity, degree, hydrogen counts, ring information,
and chirality. These properties can assist in understanding how SMARTS patterns
interact with molecular structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – The molecule for which the atom properties are to be tabulated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing four elements:</dt><dd><ul class="simple">
<li><p>headers1 (list): Primary header labels.</p></li>
<li><p>headers2 (list): Secondary header labels providing additional context.</p></li>
<li><p>data (list of lists): A list of rows with atom properties.</p></li>
<li><p>formatted_rows (list): A list of strings, each representing a formatted row.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fragmenter.utils.get_text_size">
<span class="sig-prename descclassname"><span class="pre">fragmenter.utils.</span></span><span class="sig-name descname"><span class="pre">get_text_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fragmenter.utils.get_text_size" title="Link to this definition"></a></dt>
<dd><p>Calculates the size of the text when rendered using the specified font.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>draw</strong> (<em>PIL.ImageDraw.ImageDraw</em>) – The drawing context used to measure the text.</p></li>
<li><p><strong>text</strong> (<em>str</em>) – The text string to be measured.</p></li>
<li><p><strong>font</strong> (<em>PIL.ImageFont.ImageFont</em>) – The font used for rendering the text.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (width, height) representing the dimensions of the text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fragmenter.logging.html" class="btn btn-neutral float-left" title="fragmenter.logging package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, yu9824.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>